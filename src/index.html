<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Digital Water Usage Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body { background: linear-gradient(135deg, #74ebd5, #9face6); min-height: 100vh; }
    body.dark { background: #121212; color: #f1f1f1; }
    body.dark .card { background: #1e1e1e; color: #f1f1f1; }
    .card { border-radius: 1rem; }
    @media print { .noPrint { display: none; } }
    #printUsageBtn { margin-top: 20px; }
  </style>
</head>
<body class="d-flex align-items-center justify-content-center">

<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="card shadow-lg">
        <div class="card-body p-4">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h3>ðŸ’§ Digital Water Usage</h3>
            <button class="btn btn-sm btn-outline-secondary noPrint" id="darkBtn">ðŸŒ™</button>
          </div>

          <div class="row g-2 mb-3 noPrint">
            <div class="col-md-6">
              <label class="form-label">Usage type</label>
              <select id="usageType" class="form-select noPrint" onchange="onUsageTypeChange();">
              	<option value="16">TikTok / Reddit</option>
                <option value="6">Other Social Media</option>
                <option value="50">HD Streaming</option>
                <option value="20">SD Streaming</option>
                <option value="12">Online Meetings</option>
                <option value="0.01">LLM / AI</option>
              </select>
            </div>
            <div class="col-md-6">
              <label id="usageTypeUnit" class="form-label">Time (hours)</label>
              <input type="number" id="time" class="form-control" step="0.1" />
            </div>
          </div>

          <button class="btn btn-primary w-100 mb-3 noPrint" id="addBtn">Add usage</button>

          <ul class="list-group mb-3" id="usageList"></ul>

          <div class="d-flex justify-content-between align-items-center">
            	<div class="alert alert-info mb-0" id="total">
            		Total: 0 L
        	</div>
        	<div>
        		<button class="btn btn-sm btn-outline-primary noPrint" id="unitBtn">Switch units</button>
        	</div>
        </div>
        	<button id="printUsageBtn" class="btn btn-sm btn-outline-primary noPrint" onclick="window.print();">Print my usage</button>
          <footer class="mt-4 pt-3 border-top text-center small">
						<span>
								Learn how this calculator works in our
								<a href="methodology.html" class="text-decoration-none fw-semibold">Methodology</a> | 
								<a href="https://github.com/laura-luc/online-water-usage" target="_blank" class="text-decoration-none fw-semibold">GitHub</a>
						</span>
					</footer>
        </div>
      </div>
    </div>
  </div>
</div>

<script type="module">
  import init, { add_usage, toggle_unit, remove_usage, toggle_dark } from "./pkg/rse.js";

  async function run() {
    await init();

    document.getElementById('addBtn').onclick = () => add_usage();
    document.getElementById('unitBtn').onclick = () => toggle_unit();
    document.getElementById('darkBtn').onclick = () => toggle_dark();
  }

  run();
</script>
<script>
	function onUsageTypeChange() {
		let e = document.getElementById("usageType");
		let u = document.getElementById("usageTypeUnit");
		let s = document.getElementById("time");
		if (e.selectedOptions[0].label == "LLM / AI") {
			u.innerText = "Nb. Queries";
			s.step = 1;
			console.log("Changed");
		} else {
			u.innerText = "Time (hours)";
			s.step = 0.1;
			console.log("Changed");
		}
	}
  document.getElementById("usageType")
    .addEventListener("keyup", function(event) {
      event.preventDefault();
      if (event.keyCode === 13) {
          document.getElementById("addBtn").click();
      }
  });
  document.getElementById("usageTypeUnit")
    .addEventListener("keyup", function(event) {
      event.preventDefault();
      if (event.keyCode === 13) {
          document.getElementById("addBtn").click();
      }
  })
</script>
</body>
</html>
